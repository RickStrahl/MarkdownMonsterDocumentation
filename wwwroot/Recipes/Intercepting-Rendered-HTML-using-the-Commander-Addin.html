<!DOCTYPE html>
<html>
<head>
        <meta charset="utf-8" />    
    <title>Intercepting Rendered HTML using the Commander Addin - Markdown Monster</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1" />
    <link rel="stylesheet" type="text/css" href="/docs/_kavadocs/themes/scripts/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="/docs/_kavadocs/themes/scripts/fontawesome/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="/docs/_kavadocs/themes/kavadocs.css" />

    <script src="/docs/_kavadocs/themes/scripts/jquery/jquery.min.js"></script>

    <script src="/docs/_kavadocs/themes/scripts/highlightjs/highlight.pack.js"></script>
    <script src="/docs/_kavadocs/themes/scripts/highlightjs-badge.min.js"></script>
    <link href="/docs/_kavadocs/themes/scripts/highlightjs/styles/vs2015.css" rel="stylesheet" />

    <script src="/docs/_kavadocs/themes/scripts/ww.jquery.min.js"></script>
    <script>        
        window.page = {};
        window.page.basePath = "/docs/";      
    </script>
    <script src="/docs/_kavadocs/themes/scripts/kavadocs.js"></script>
    

    <topictype value="topic" />

    <script id="MermaidScript" src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>    
        $(document).ready(function () {
            helpBuilder.initializeLayout();
            // expand all top level topics
            setTimeout(helpBuilder.tocExpandTop, 5);
        });
    </script>
    <style>
        .toc li .fa-arrow-up-right-from-square {
            font-size: 0.7em;
            color: goldenrod;
            margin-left: 0.1em;
        }
    </style>

    </head>
<body>    
    <!-- Markdown Monster Content -->
    <div class="flex-master">
        <div class="banner">

            <div class="float-start sidebar-toggle">
                <i class="fa fa-bars"
                   title="Show or hide the topics list"></i>
            </div>
            <img src="/docs/images/logo.png" class="banner-logo" />
         
            	<div class="projectname"> Markdown Monster</div>

            <div class="byline">                
                <img src="/docs/_kavadocs/icons/topic.png">
                Intercepting Rendered HTML using the Commander Addin
            </div>
        </div>
        <div class="page-content">
            <div id="toc" class="sidebar-left toc-content">
                <nav class="visually-hidden">
                    <a href="/docs/tableofcontents.html">Table of Contents</a>
                </nav>
            </div>

            <div class="splitter">
            </div>

            <nav class="topic-outline">
                <div class="topic-outline-header">On this page:</div>
                <div class="topic-outline-content"></div>
            </nav>

            <div id="MainContent" class="main-content">
                <!-- Rendered Content -->
                <article class="content-pane">
                    

<h2 class="content-title">
    <img src="/docs/_kavadocs/icons/topic.png">
    Intercepting Rendered HTML using the Commander Addin
</h2>




<div class="content-body" id="body">
            <p>Markdown Monster supports intercepting the Markdown and generated HTML and making modifications using full featured .NET Addins or - for simple things - using the <a href="https://github.com/RickStrahl/Commander-MarkdownMonster-Addin" target="top">Commander</a> or <a href="https://github.com/rickstrahl/snippets-markdownmonster-addin" target="top">Snippets</a> addins. Full addins take a bit of effort, but using the <strong>Commander add in</strong> can be very easy.</p>
<p>Here's a use case somebody asked about recently:</p>
<blockquote>
<p>I use HTML comments in my markdown to break up my Markdown text, but I don't want to render the comments into the output. Is there a way to strip the comments?</p>
</blockquote>
<p>Yes it's possible to intercept the rendering process using a couple of events on the <code>MarkdownDocument</code> object in Markdown monster.</p>
<p>Using the Command add in you can create a commander script that looks like this:</p>
<p><img src="/docs/images/commandaddin-intercepthtml.png" alt="" /></p>
<p>To do this:</p>
<ul>
<li>Use the Addin Manager to install the <strong>Commander Addin</strong></li>
<li>Use <strong>Add Command</strong> to create a new Command Script</li>
<li>Enter the code shown below</li>
<li>Run Command to test and make sure there are no compilation errors</li>
</ul>
<p>To get the addin to work you need to run the command or you can create a hot key to activate it. <strong>It will not automatically run</strong> and the command is effectively bound to the document you run it on.</p>
<p>Here's the code that hooks up the event:</p>
<pre><code class="language-cs">using System.Text.RegularExpressions

var doc = Model.ActiveDocument as MarkdownDocument;
doc.DocumentRendered += (html,markdown) =&gt;
{
    if (string.IsNullOrEmpty(html))
        return html;
        
        
    return Regex.Replace(html, 
                 &quot;&lt;!--.*?--&gt;&quot;, &quot;&quot;,
                 RegexOptions.IgnoreCase | RegexOptions.Multiline);
};
</code></pre>
<h3 id="creating-an-addin">Creating an Addin</h3>
<p>If you want a more permanent solution that fires without explicit interaction you can create a full addin.</p>
<ul>
<li><a href="https://markdownmonster.west-wind.com/docs/_4ne0s0qoi.htm">Create Markdown Monster Addin</a></li>
<li><a href="https://markdownmonster.west-wind.com/docs/_4ut0j9cm6.htm">Creating non-visual Addins</a></li>
</ul>
<p>Addins have a dedicated method for modifying the rendered HTML (or Markdown) <code>OnModifyPreviewHtml()</code> and you can override the HTML in this method using the same Regex logic used in the Commander script above.</p>
<pre><code class="language-cs">public class StripCommentsAddin : MarkdownMonster.AddIns.MarkdownMonsterAddin
{
    public override void OnApplicationStart()
    {
        Id = &quot;StripCommentsAddin&quot;;
        Name = &quot;Strip Comments From HTML&quot;;            
    }

    public override OnModifyPreviewHtml(html, markdown)
    {
        return Regex.Replace(html, 
                    &quot;&lt;!--.*?--&gt;&quot;, &quot;&quot;,
                    RegexOptions.IgnoreCase | RegexOptions.Multiline);
    }
}
</code></pre>

    </div>



                </article>

                <hr />
                <div class="float-end">
                    <a href="http://helpbuilder.west-wind.com" target="_blank"><img src="/docs/_kavadocs/images/docmonster.png" style="height: 2.5em"/></a>
                </div>

                <div style="font-size: 0.75em">
                     &copy; West Wind Technologies, 2025 &bull;
                    updated: 2025-02-23
                    <br />
                                        <a href="mailto:support@west-wind.com?subject=Support: Markdown Monster - Intercepting Rendered HTML using the Commander Addin&body=Project%3A%20Markdown%20Monster%0ATopic%3A%20Intercepting%20Rendered%20HTML%20using%20the%20Commander%20Addin%0A%0AUrl%3A%0Ahttps%3A%2F%2Fmarkdownmonster.west-wind.com%2Fdocs%2F_5AB0ZU71B.html">Comment or report problem with topic</a>
                </di>
                <br class="clearfix" />
                <br />
                <!-- End Rendered Content -->
            </div>
        </div>
    </div>
    <!-- End Markdown Monster Content -->
</body>
</html>

