<!DOCTYPE html>
<html>
<head>
        <meta charset="utf-8" />    
    <title>Customizing the Addin Icon and Menu Button - Markdown Monster</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1" />
    <link rel="stylesheet" type="text/css" href="/docs/_kavadocs/themes/scripts/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="/docs/_kavadocs/themes/scripts/fontawesome/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="/docs/_kavadocs/themes/kavadocs.css" />

    <script src="/docs/_kavadocs/themes/scripts/jquery/jquery.min.js"></script>

    <script src="/docs/_kavadocs/themes/scripts/highlightjs/highlight.pack.js"></script>
    <script src="/docs/_kavadocs/themes/scripts/highlightjs-badge.min.js"></script>
    <link href="/docs/_kavadocs/themes/scripts/highlightjs/styles/vs2015.css" rel="stylesheet" />

    <script src="/docs/_kavadocs/themes/scripts/ww.jquery.min.js"></script>
    <script>        
        window.page = {};
        window.page.basePath = "/docs/";      
    </script>
    <script src="/docs/_kavadocs/themes/scripts/kavadocs.js"></script>
    

    <topictype value="topic" />

    <script id="MermaidScript" src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>    
        $(document).ready(function () {
            helpBuilder.initializeLayout();
            // expand all top level topics
            setTimeout(helpBuilder.tocExpandTop, 5);
        });
    </script>
    <style>
        .toc li .fa-arrow-up-right-from-square {
            font-size: 0.7em;
            color: goldenrod;
            margin-left: 0.1em;
        }
    </style>

    </head>
<body>    
    <!-- Markdown Monster Content -->
    <div class="flex-master">
        <div class="banner">

            <div class="float-start sidebar-toggle">
                <i class="fa fa-bars"
                   title="Show or hide the topics list"></i>
            </div>
            <img src="/docs/images/logo.png" class="banner-logo" />
         
            	<div class="projectname"> Markdown Monster</div>

            <div class="byline">                
                <img src="/docs/_kavadocs/icons/topic.png">
                Customizing the Addin Icon and Menu Button
            </div>
        </div>
        <div class="page-content">
            <div id="toc" class="sidebar-left toc-content">
                <nav class="visually-hidden">
                    <a href="/docs/tableofcontents.html">Table of Contents</a>
                </nav>
            </div>

            <div class="splitter">
            </div>

            <nav class="topic-outline">
                <div class="topic-outline-header">On this page:</div>
                <div class="topic-outline-content"></div>
            </nav>

            <div id="MainContent" class="main-content">
                <!-- Rendered Content -->
                <article class="content-pane">
                    

<h2 class="content-title">
    <img src="/docs/_kavadocs/icons/topic.png">
    Customizing the Addin Icon and Menu Button
</h2>




<div class="content-body" id="body">
            <p>There are a few different ways you can specify icons for to be displayed on the toolbar for your addin. Addin icons are sequentially added to the end of the rightmost toolbar.</p>
<p><img src="/docs//images/AddinsToolbar.png" alt="" /></p>
<p>You'll notice that the icons on the toolbar have varying icons. The first three icons are image icons, while the last two are FontAwesome icons.</p>
<h3 id="specifying-icons-in-the-addin">Specifying Icons in the Addin</h3>
<p>The basic process of adding icons is done as part of the <code>OnApplicationInitialized()</code> operation:</p>
<p>The following uses a FontAwesomeIcon and optional color:</p>
<pre><code class="language-cs">public override Task OnApplicationInitialized()
{
    Id = &quot;PasteCodeAsGist&quot;;

    AddinMenuItem = new AddInMenuItem(this)
    {
        Caption = &quot;Gist&quot;,
        FontawesomeIcon = FontAwesomeIcon.Github,
        FontawesomeIconColor = &quot;#247CAC&quot;
    };

    MenuItems.Add(AddinMenuItem);            
    
    return Task.CompletedTask;
}
</code></pre>
<p>Alternately you can also specify an <code>ImageSource</code>. Instead of the <code>Fontawesome</code>  properties set the <code>IconImageSource</code> property instead:</p>
<pre><code class="language-cs">AddinMenuItem = new AddInMenuItem(this)
{
    Caption = &quot;Gist&quot;,
    FontawesomeIcon = FontAwesomeIcon.Github,
    FontawesomeIconColor = &quot;#247CAC&quot;
}

try 
{
  AddinMenuItem.IconImageSource = new ImageSourceConverter()
        .ConvertFromString(&quot;pack://application:,,,/GistIntegrationAddin;component/icon_22.png&quot;) 
        as ImageSource
}
catch{ }
</code></pre>
<blockquote>
<h3 id="--image-resources"><i class="fas fa-info-circle" style="font-size: 1.1em"></i>  Image Resources</h3>
<p>We recommend when you use image resources that you also specify a FontAwesome icon and put the image retrieval into a <code>try/catch</code> block. Should the image retrieval fail, your addin will still load with the FontAwesome icon as a fall back.</p>
</blockquote>
<blockquote>
<h3 id="--threading-issue"><i class="fas fa-info-circle" style="font-size: 1.1em"></i>  Threading Issue</h3>
<p>Markdown Monster performs initial addin loading asynchronously on a separate thread, so when the icons are initially attached, you may not be on the UI thread. This can in some cases cause odd behavior with WPF when loading images from external resources. If you run into trouble with this, see the section on post-processing images in the <code>OnWindowLoaded()</code> event.</p>
</blockquote>
<h3 id="modifying-the-menu-button-and-image-icon">Modifying the Menu Button and Image Icon</h3>
<p>The above options allow you to assign either a font-awesome icon or a simple image resource. If you need to perform additional modification on either the icon or the menu item itself you can do this in the <code>OnWindowLoaded()</code> event which provides access to the Menu Button via the <code>Addin.MenuItemButton</code> property.</p>
<p>The following example completely replaces the existing icon with a new icon image source and explicitly manipulates the menu button size:</p>
<pre><code class="language-cs">public override void OnWindowLoaded()
{
    var mButtonContent = AddinMenuItem.MenuItemButton?.Content;
    if (mButtonContent != null)
    {
        var image = (Image) mButtonContent;
        image.Source = ImageAwesome.CreateImageSource(FontAwesomeIcon.GithubAlt, new BrushConverter().ConvertFrom(&quot;#247CAC&quot;) as Brush);
        image.Height = 22;
        image.Width = 22;
    }
</code></pre>
<h3 id="not-showing-addin-buttons-and-dropdowns">Not Showing Addin Buttons And DropDowns</h3>
<p>In some cases you may have addins that don't need to show an Icon or menu item, or only needs to show the main icon  but not a configuration option. You can control these UI items by disabling their respective execution handlers, which by default point at the addins <code>OnExecute</code> and <code>OnExecuteConfiguration</code> methods. By setting them to null you disable their functionality and their UI.</p>
<p>To remove the Toolbar Icon altogether, simply set the <code>Execute</code> Task to <code>null</code>:</p>
<pre><code class="language-csharp">var menuItem = new AddInMenuItem(this)
{
	Caption = &quot;Non Visible Addin&quot;,
	Execute = null
};
MenuItems.Add(menuItem);
</code></pre>
<p>An example of a non-visible Markdown Monster Addin may be a custom Markdown parser addin that only replaces the parser transparently.</p>
<p>To remove the Configuration drop down but leave the main icon in place:</p>
<pre><code class="language-csharp">var menuItem = new AddInMenuItem(this)
{
	Caption = &quot;No Config Addin&quot;,
	ExecuteConfigration = null
};
MenuItems.Add(menuItem);
</code></pre>
<p>An example of an addin that doesn't have configuration is the Chromium WebView Previewer addin which only uses the main Toolbar button as an on-off toggle and has no additional configuration.</p>

    </div>



    <h4 class="outdent" id="seealso">See also</h4>
    <div class="see-also-container">
        <div>Attach additional Menu Items from your Addin</div>

    </div>
                </article>

                <hr />
                <div class="float-end">
                    <a href="http://helpbuilder.west-wind.com" target="_blank"><img src="/docs/_kavadocs/images/docmonster.png" style="height: 2.5em"/></a>
                </div>

                <div style="font-size: 0.75em">
                     &copy; West Wind Technologies, 2025 &bull;
                    updated: 2025-02-23
                    <br />
                                        <a href="mailto:support@west-wind.com?subject=Support: Markdown Monster - Customizing the Addin Icon and Menu Button&body=Project%3A%20Markdown%20Monster%0ATopic%3A%20Customizing%20the%20Addin%20Icon%20and%20Menu%20Button%0A%0AUrl%3A%0Ahttps%3A%2F%2Fmarkdownmonster.west-wind.com%2Fdocs%2F_52A19SBGX.html">Comment or report problem with topic</a>
                </di>
                <br class="clearfix" />
                <br />
                <!-- End Rendered Content -->
            </div>
        </div>
    </div>
    <!-- End Markdown Monster Content -->
</body>
</html>

