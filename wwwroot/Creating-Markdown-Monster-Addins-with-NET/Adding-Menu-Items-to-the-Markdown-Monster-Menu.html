<!DOCTYPE html>
<html>
<head>
        <meta charset="utf-8" />    
    <title>Adding Menu Items to the Markdown Monster Menu - Markdown Monster</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1" />
    <link rel="stylesheet" type="text/css" href="/docs/_kavadocs/themes/scripts/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="/docs/_kavadocs/themes/scripts/fontawesome/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="/docs/_kavadocs/themes/kavadocs.css" />

    <script src="/docs/_kavadocs/themes/scripts/jquery/jquery.min.js"></script>

    <script src="/docs/_kavadocs/themes/scripts/highlightjs/highlight.pack.js"></script>
    <script src="/docs/_kavadocs/themes/scripts/highlightjs-badge.min.js"></script>
    <link href="/docs/_kavadocs/themes/scripts/highlightjs/styles/vs2015.css" rel="stylesheet" />

    <script src="/docs/_kavadocs/themes/scripts/ww.jquery.min.js"></script>
    <script>        
        window.page = {};
        window.page.basePath = "/docs/";      
    </script>
    <script src="/docs/_kavadocs/themes/scripts/kavadocs.js"></script>
    

    <topictype value="topic" />

    <script id="MermaidScript" src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>    
        $(document).ready(function () {
            helpBuilder.initializeLayout();
            // expand all top level topics
            setTimeout(helpBuilder.tocExpandTop, 5);
        });
    </script>
    <style>
        .toc li .fa-arrow-up-right-from-square {
            font-size: 0.7em;
            color: goldenrod;
            margin-left: 0.1em;
        }
    </style>

    </head>
<body>    
    <!-- Markdown Monster Content -->
    <div class="flex-master">
        <div class="banner">

            <div class="float-start sidebar-toggle">
                <i class="fa fa-bars"
                   title="Show or hide the topics list"></i>
            </div>
            <img src="/docs/images/logo.png" class="banner-logo" />
         
            	<div class="projectname"> Markdown Monster</div>

            <div class="byline">                
                <img src="/docs/_kavadocs/icons/topic.png">
                Adding Menu Items to the Markdown Monster Menu
            </div>
        </div>
        <div class="page-content">
            <div id="toc" class="sidebar-left toc-content">
                <nav class="visually-hidden">
                    <a href="/docs/tableofcontents.html">Table of Contents</a>
                </nav>
            </div>

            <div class="splitter">
            </div>

            <nav class="topic-outline">
                <div class="topic-outline-header">On this page:</div>
                <div class="topic-outline-content"></div>
            </nav>

            <div id="MainContent" class="main-content">
                <!-- Rendered Content -->
                <article class="content-pane">
                    

<h2 class="content-title">
    <img src="/docs/_kavadocs/icons/topic.png">
    Adding Menu Items to the Markdown Monster Menu
</h2>




<div class="content-body" id="body">
            <p>You can also add new menu items to the existing Markdown Monster main menu by using the <code>AddMenuItem()</code> method on the Addin class.</p>
<p>To do this:</p>
<ul>
<li>Add an <code>OnWindowLoaded()</code> overload</li>
<li>Create a Menu Item with Header and Click handler</li>
<li>Call <code>Addin.AddMenuItem()</code></li>
</ul>
<p><code>AddMenuItem()</code> allows adding a WPF menu item <strong>before</strong> or <strong>after</strong> an existing menu item, either by menu item <code>Name</code> or the header text in the <code>Header</code> property. Important: The name or header have to match <strong>exactly</strong> in order for the existing menu item to be found. You can look up the <a href="https://github.com/RickStrahl/MarkdownMonster/blob/master/MarkdownMonster/MainWindow.xaml#L224">menu items in the source code</a> - look for the <code>Name=&quot;MainMenu&quot;</code> and look through the items there.</p>
<blockquote>
<p><i class="fas fa-warning" style="font-size: 1.1em"></i>  If the source menu item is not found the new menu item is not inserted and fails silently. The error is logged, but there's no visual clue that it failed in the UI.</p>
</blockquote>
<p>By default new menu items are added after the matched element, but you can override and insert before or replace a menu item using the <code>addMode</code> enum parameter.</p>
<p>The following addin adds two menu items to Markdown Monster's <em>File</em> menu:</p>
<pre><code class="language-cs">public override Task OnWindowLoaded()
{
    // create and add custom menu item
    var mitemOpen = new MenuItem()
    {
        Header = &quot;Open from Gist&quot;,
        Name = &quot;ButtonOpenFromGist&quot;
    };
    mitemOpen.Click += (s, a) =&gt; OnExecuteLoadGist();
    if (!AddMenuItem(mitemOpen, menuItemNameForInsertionAfter: &quot;ButtonOpenFromHtml&quot;))
        mmApp.Log(&quot;Unable to add custom menu item in Paste Code As Gist Addin: &quot; + mitemOpen.Name);

    var mitemSave = new MenuItem()
    {
        Header = &quot;Save to Gist&quot;,
        Name = &quot;ButtonSaveToGist&quot;
    };
    mitemSave.Click += (s, a) =&gt; OnExecuteSaveGist();
    if (!AddMenuItem(mitemSave, menuItemNameForInsertionAfter: &quot;ButtonGeneratePdf&quot;))
        mmApp.Log(&quot;Unable to add custom menu item in Paste Code As Gist Addin: &quot; + mitemSave.Name);
        
    return Task.CompletedTask;
}
</code></pre>
<blockquote>
<h4 id="--use-onwindowload"><i class="fas fa-warning" style="font-size: 1.1em"></i>  Use OnWindowLoad()</h4>
<p>Note that this code has to run in <code>OnWindowLoaded()</code> because it requires access to the Window and dispatcher and that the window and controls are already loaded. <code>OnWindowInitialized()</code> fires too early for direct UI interactions.</p>
</blockquote>
<h3 id="addmenuitem">AddMenuItem()</h3>
<p>The AddMenuItem function lets you add a menu item before or after an existing menu item. To use it you provide a menu item, and either a menu item name or header caption. You can also specify whether the new menu item is added before or after the first match.</p>
<p>The signature is:</p>
<pre><code class="language-cs">public bool AddMenuItem(
  MenuItem mitem,
  string menuItemNameForInsertionAfter = null,
  string menuItemTextForInsertionAfter = null,
  AddMenuItemModes addMode = AddMenuItemModes.AddAfter)
</code></pre>
<blockquote>
<h4 id="--finding-menu-item-names"><i class="fas fa-info-circle" style="font-size: 1.1em"></i>  Finding Menu Item Names</h4>
<p>You can check for Menu Item names for use in <code>menuItemNameForInsertionAfter</code> in the Markdown Monster <a href="https://github.com/RickStrahl/MarkdownMonster/blob/master/MarkdownMonster/MainWindow.xaml" target="top">MainWindow.xaml source code</a>. Note that not all menu items have names, so for those that don't use can use the menu item's <code>Header</code> property or content value instead with  <code>menuItemTextForInsertionAfter</code>.</p>
</blockquote>

    </div>



                </article>

                <hr />
                <div class="float-end">
                    <a href="http://helpbuilder.west-wind.com" target="_blank"><img src="/docs/_kavadocs/images/docmonster.png" style="height: 2.5em"/></a>
                </div>

                <div style="font-size: 0.75em">
                     &copy; West Wind Technologies, 2025 &bull;
                    updated: 2025-02-24
                    <br />
                                        <a href="mailto:support@west-wind.com?subject=Support: Markdown Monster - Adding Menu Items to the Markdown Monster Menu&body=Project%3A%20Markdown%20Monster%0ATopic%3A%20Adding%20Menu%20Items%20to%20the%20Markdown%20Monster%20Menu%0A%0AUrl%3A%0Ahttps%3A%2F%2Fmarkdownmonster.west-wind.com%2Fdocs%2F_4ZV0O3R46.html">Comment or report problem with topic</a>
                </di>
                <br class="clearfix" />
                <br />
                <!-- End Rendered Content -->
            </div>
        </div>
    </div>
    <!-- End Markdown Monster Content -->
</body>
</html>

